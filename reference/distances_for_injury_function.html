<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Computes exposures (distances) by mode to parameterise the injury regression model,
which is computed as a Poisson model and which is used in the ITHIM-Global model
to predict injury fatalities at a later stage"><title>Get distances and parameterise Poisson regression model for injuries — distances_for_injury_function • ithimr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get distances and parameterise Poisson regression model for injuries — distances_for_injury_function"><meta property="og:description" content="Computes exposures (distances) by mode to parameterise the injury regression model,
which is computed as a Poisson model and which is used in the ITHIM-Global model
to predict injury fatalities at a later stage"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ithimr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/how-to-run-ITHIM.html">How to run ITHIM</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ITHIM/ITHIM-R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Get distances and parameterise Poisson regression model for injuries</h1>
      <small class="dont-index">Source: <a href="https://github.com/ITHIM/ITHIM-R/blob/HEAD/R/distances_for_injury_function.R" class="external-link"><code>R/distances_for_injury_function.R</code></a></small>
      <div class="d-none name"><code>distances_for_injury_function.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes exposures (distances) by mode to parameterise the injury regression model,
which is computed as a Poisson model and which is used in the ITHIM-Global model
to predict injury fatalities at a later stage</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">distances_for_injury_function</span><span class="op">(</span><span class="va">journeys</span>, <span class="va">dist</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>journeys</dt>
<dd><p>data frame with total distance (by total population) for each age and sex category and for each scenario</p></dd>


<dt>dist</dt>
<dd><p>table of (total population) distances per mode</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>true_distances (mode distances by age and sex with all walking modes and all car modes combined and bus drivers added where relevant),</p>


<p>injuries_list (list of all strike, casualty, age, sex and mode distance combinations for baseline and all scenarios),</p>


<p>reg_model (parameterised Poisson regression model),</p>


<p>injuries_for_model (baseline data containing injury counts for all casualty and strike mode combinations with associated distance data)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function uses distance data and the individual injury fatality data to perform the following steps
to parameterise the Poisson injury regression model:</p>
<ul><li><p>stage modes are aggregated such that all walk related stages (walk and walk to pt) are of the same mode (walk),
   similarly for all car related journeys</p></li>
<li><p>bus drivers are added to bus journeys (where relevant) to accurately represent all people on a bus</p></li>
<li><p>Takes Baseline injury tables, split into who-hit whom (whw) and no-other-vehicle (nov) parts,
   and adds total population distances for each strike and casualty mode (add_distance_columns.R).
   Distances are added by age and gender category if there exists such information for
   the injury counts (injuries_for_model dataframe). If there exists a fatality for some casualty and
   strike mode and age and sex category but no mode distance for this age and sex category,
   then fatalities and distances are aggregated by strike and casualty mode.
   If, after the aggregation there still exist fatalities for which either casualty
   or strike mode distance are missing, then these fatalities are removed as we cannot
   predict injury counts on zero distances. However, this should not happen
   as we should have total distances for all modes (possibly inferred
   from other modes) that appear in the injury data. - This data is used to parameterise the
   Poisson injury model.</p></li>
<li><p>A new list (injuries_list) is created containing all strike and casualty mode and age and sex combinations
   together with strike and casualty mode distances (<code><a href="add_distance_columns.html">add_distance_columns()</a></code>) for the baseline and all scenarios. For
   the whw model, any strike mode and casualty pairs where strike mode equals casualty mode
   are removed as fatalities for these combinations have already been added to the nov matrix.
   Combinations which do not have a non-zero strike or casualty mode distance
   are also removed. This list will later be used in the <code><a href="injuries_function_2.html">injuries_function_2()</a></code> function
   to predict fatality counts using the Poisson injury regression model.</p></li>
<li><p>The casualty and strike mode exponents used to account for the safety in number effect
   are added to both the injuries_for_model and injuries_list.</p></li>
<li><p>The best possible regression model is being built using Baseline injury counts and distances
   (injuries_for_model) such that the standard errors are small wherever possible. Strike
   and casualty mode pairs where cas mode = strike mode are removed if they still exist
   which they should not as they should have been removed by the ithim_load_data.R function.
   Two different forms for whw and nov matrices are defined, taking into account age and sex
   information where it exists. The standard errors of the newly built regression models
   are checked and if they are too large and if the data has not been aggregated by age
   and sex yet, then the data is aggregated and a new Poisson regression model is build.
   If the standard errors are still large after this aggregation, then a message is
   printed to the screen warning that the standard errors are large.</p></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Ali Abbas, Anna Schroeder, Daniel Gil, Lambed Tatah, Rob Johnson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

