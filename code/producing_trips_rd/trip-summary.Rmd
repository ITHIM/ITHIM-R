---
title: "Trip Summary ITHIM-R"
author: ""
date: "`r format(Sys.time(), '%d %B, %Y')`"
output: html_document
---


```{r, include = FALSE}
source("used_functions.R")
knitr::opts_chunk$set(comment=NA, prompt=FALSE, cache=FALSE, echo=F, results='asis')
```

```{r loadLibraries, echo = F, message = F}

st_options(bootstrap.css     = FALSE,       # Already part of the theme so no need for it
           plain.ascii       = FALSE,       # One of the essential settings
           style             = "rmarkdown", # Idem.
           dfSummary.silent  = TRUE,        # Suppresses messages about temporary files
           footnote          = NA,          # Keeping the results minimalistic
           subtitle.emphasis = FALSE)       # For the vignette theme, this gives
                                            # much better results. Your mileage may vary

```
```{r,  comment=NA, message=FALSE, warning=FALSE, prompt=FALSE, cache=FALSE, echo=F}
data.frame(
  Ciudad = c("Buenos Aires", "Sao Paulo", "Belo Horizonte", "Mexico", "Bogota",
             "Santiago", "Visakhapatnam", "Delhi", "Bangalore", "Accra",
             "Cape Town"),
  Study_area = c("BA and 27 municipalities.",
                 "Metropolitan region of SP.",
                 "Metropolitan region of BH.",
                 "Metropolitan area of Mexico city.",
                 "Bogota and surrounding municipalities.",
                 "Metropolitan region of Santiago.",
                 "There's not a report with survey details.",
                 "There's not a report with survey details.",
                 "Not sure",
                 "The whole country but filtered only Greater Accra",
                 "Cape Town, Malmesbury and Paarl"),
  year = c("2010",
           "2017",
           "2012",
           "2017",
           "2019",
           "2012",
           "",
           "",
           "",
           "",
           ""),
  # Definition of a trip
  Trip_definition = c(
    # BA: Pag 23- Report.pdf
    "Moving from a origin to a destiny with a specific reason/motive",
                      "Moving for a specific reason between two specific points (origin and destination), using one or more modes of transport. Walking trips where the reason for the trip is work or school, regardless of the distance travelled; or the distance covered is more than 500 mts for other reasons.",
    # Belo Horizonte: pag 16, "Codebook and protocol.pdf"
    "Moving from one part to another with a specific reason/motive, using one or more modes of transport",
    # Mexico city
    "Moving from one part to another with a specific reason/motive, using one or multiples modes of transport",
    # Bogota
    "Moving from one part to another with a specific reason/motive, a definite hour of start and end, a mode of transport, and a duration greater than 3 minutes. Or moving from one part to another with reason/motive work or study of any duration",
                      "Any movement carried out on public roads with a purpose
determined, between two places (origin and destination) at a certain time of day; It can be carried out in several modes of transport and consist of one or more stages",
"",
"",
"",
"",
""),
  Reference_period = c(
    # BA: page 4, report.pdf
    "Trips made in working days",
    "Trips made the day before the survey (from 4am yesterday to 3:59am today).",
    "",
    # Mexico city
                       "Trips made during the week (Tuesday, Wednesday, Thursday) and in Saturdays (weekends)",
    # Bogota
                       "Trips made the day of reference, i.e., the day before the survey (from 4am yesterday to 4am today). Surveys made from Monday to Sunday (according to the dataset).",
                       "Trips made in working days (regular season), in weekends (regular season) and in working days(summer season)",
                       "",
                       "",
                       "",
                       "",
                       ""),
  # Is there information at stage level?
  Trip_Stage = c("Stage", "Trip", "Trip", "Stage", "Trip", 
                 "Trip", "Trip", "Stage", "Stage", "Trip",
                 "Trip"),
  # If not, what is missing?
  Stage_missing = c(
    "N/A", 
    "There's no stage duration", 
    "No stage information", 
    # Mexico city
    "N/A", 
    # Bogota
    "There's no stage duration",
    "There's no stage duration",
    "There's no stage mode, duration",
    "N/A",
    "N/A",
    "Not sure, because it asks about modes and duration but don't know if people answered with this level of detail.",
    "Looks like the survey capture up to 5 stage modes, but duration was not asked."
    ),
  # Is there information about short walks to pt
  Walk_to_from_pt = c("Yes, in blocks (not minutes)",
                      "Yes",
                      "No",
                      "Yes",
                      "Yes",
                      "Yes",
                      "No",
                      "Not sure",
                      "Yes",
                      "Not sure, because it asks about modes and duration but don't know if people answered with this level of detail.",
                      "No"),
Walking_in_trip_duration = c("Not sure, yet.",
                             "Yes",
                             "N/A",
                             "Yes",
                             "Yes",
                             "Not included",
                             "N/A",
                             "Not sure, yet.",
                             "Yes",
                             "Not sure, yet",
                             "No"),
  ToDo = c("Need to check if injuries dataset covers the same area that travel survey does. \n There's information about walking stages (blocks not minutes) but is not used",
           "Need to check if injuries dataset covers the same area that travel survey does. \n Travel survey from 2012, there is one from 2017.",
           # Belo horizonte: page 81, "Codebook and protocol.pdf"
           "Need to check if injuries dataset covers the same area that travel survey does. \n According to the documentation, it looks like there's information at stage level (including stage duration).",
           "Need to check if injuries dataset covers the same area that travel survey does. Trip mode is defined in terms of speed and duration, while in other surveys there's a hierarchy (check this). There's information on weekdays and weekends, decide what to do with this.",
           "Need to check if injuries dataset covers the same area that travel survey does (The one that I got it's from only Bogota). Need to update travel survey.",
           "Need to check if injuries dataset covers the same area that travel survey does. There's information about trips on working days in regular season and and working days in summer season, decide what to do with this.",
           "Need to find a report to check the details of this survey",
           "Need to find a report to check the details of this survey",
           "There's a report called Comprehensive Traffic and Transportation Study for Bangalore Metropolitan region but I'm not sure if it corresponds to the data. Trip mode is defined in terms of speed and duration, while in other surveys there's a hierarchy (check this)",
           "Need to check if injuries dataset covers the same area that time use survey does. Need to check if stages were captured.",
           "Need to check if injuries dataset covers the same area that time use survey does."),
           # Is the data ok?
  OK = c("--", "--", "--", "--", "--", 
         "--", "--", "--", "--", "--", "--")
  ) %>% kbl() %>% kable_classic()

# (If short walk is not explicitly recorded, we have to find a way to remove; if they are missing, what should we do?)

# Sao Paulo:
# 1) Walking trips: Page 60, Pesquisa de Mobilidade da RMSP –2012 –Manual da Pesquisa Domiciliar
# Belo horizonte:
# 1) Study area: page 35, codebook and protocol.pdf
# Cape town:
# 1) Main mode Hierarchy: page 45, Final Draft HH Survey Report.pdf
```

```{r,  comment=NA, message=FALSE, warning=FALSE, prompt=FALSE, cache=FALSE, echo=F}
trip <- read_csv("../../data/local/buenos_aires/buenos_aires_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Buenos_Aires <- value

trip <- read_csv("../../data/local/sao_paulo/sao_paulo_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Sao_Paulo <- value

trip <- read_csv("../../data/local/belo_horizonte/belo_horizonte_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Belo_Horizonte <- value

trip <- read_csv("../../data/local/mexico_city/mexico_city_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Mexico <- value

trip <- read_csv("../../data/local/bogota/bogota_trips.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Bogota <- value

trip <- read_csv("../../data/local/santiago/santiago_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Santiago <- value

trip <- read_csv("../../data/local/vizag/vizag_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Visakhapatnam <- value

trip <- read_csv("../../data/local/delhi/delhi_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Delhi <- value

trip <- read_csv("../../data/local/bangalore/bangalore_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Bangalore <- value

trip <- read_csv("../../data/local/accra/accra_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Accra <- value

trip <- read_csv("../../data/local/cape_town/cape_town_trip.csv",
                 guess_max = 100000)
quality_check(trip)
trip_summary$Cape_Town <- value



```


```{r, include = TRUE,  echo= FALSE, results='asis'}
kable(trip_summary) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"), font_size = 14, fixed_thead = T)
    
```
