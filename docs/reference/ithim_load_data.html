<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Loads and processes data from files using both city specific local data and global data. Processes the
input data ready for the ITHIM-Global model run. Writes objects to the global environment."><title>Load data for model and prepare input data for model — ithim_load_data • ithimr</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Load data for model and prepare input data for model — ithim_load_data"><meta property="og:description" content="Loads and processes data from files using both city specific local data and global data. Processes the
input data ready for the ITHIM-Global model run. Writes objects to the global environment."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">ithimr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.2</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ITHIM/ITHIM-R/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Load data for model and prepare input data for model</h1>
      <small class="dont-index">Source: <a href="https://github.com/ITHIM/ITHIM-R/blob/bogota/R/ithim_load_data.R" class="external-link"><code>R/ithim_load_data.R</code></a></small>
      <div class="d-none name"><code>ithim_load_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Loads and processes data from files using both city specific local data and global data. Processes the
input data ready for the ITHIM-Global model run. Writes objects to the global environment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ithim_load_data</span><span class="op">(</span></span>
<span>  speeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bus <span class="op">=</span> <span class="fl">10</span>, bus_driver <span class="op">=</span> <span class="fl">10</span>, minibus <span class="op">=</span> <span class="fl">10</span>, minibus_driver <span class="op">=</span> <span class="fl">10</span>, car <span class="op">=</span> <span class="fl">14.4</span>,</span>
<span>    car_driver <span class="op">=</span> <span class="fl">14.4</span>, taxi <span class="op">=</span> <span class="fl">12.6</span>, pedestrian <span class="op">=</span> <span class="fl">2.5</span>, walk_to_pt <span class="op">=</span> <span class="fl">2.5</span>, cycle <span class="op">=</span> <span class="fl">7.2</span>,</span>
<span>    motorcycle <span class="op">=</span> <span class="fl">15.2</span>, truck <span class="op">=</span> <span class="fl">10</span>, van <span class="op">=</span> <span class="fl">14.4</span>, subway <span class="op">=</span> <span class="fl">18.1</span>, rail <span class="op">=</span> <span class="fl">21.9</span>, auto_rickshaw</span>
<span>    <span class="op">=</span> <span class="fl">4</span>, shared_auto <span class="op">=</span> <span class="fl">14.4</span>, shared_taxi <span class="op">=</span> <span class="fl">12.6</span>, cycle_rickshaw <span class="op">=</span> <span class="fl">4</span>, other <span class="op">=</span> <span class="fl">9.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>speeds</dt>
<dd><p>named list of mode speeds</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function performs the following steps to load and process the input data:</p>
<ul><li><p>find path of ithimr package where global and local data can be found</p></li>
<li><p>check whether drpa package is installed</p></li>
<li><p>read in Global Burden of Disease data for country</p></li>
<li><p>read in city specific trip data:</p>
<p></p><ul><li><p>set missing stage or trip information to known stage or trip information, 
     e.g. if stage duration is missing but trip duration is known then set stage duration to trip duration</p></li>
<li><p>ensure that stage modes and trip modes only consist of set keywords, replace all other mode names by those key
     words, e.g. replace 'train' by 'rail'</p></li>
<li><p>remove trips where age or sex are 'NA'</p></li>
<li><p>Rename pedestrian stage modes of non-pedestrian trips from 'pedestrian' to 'walk_to_pt'</p></li>
<li><p>remove any walk_to_pt stages that do not belong to either a rail or a bus trip modes</p></li>
<li><p>(call get_scenario_settings() if using the max_mode_share_scenario)</p></li>
</ul></li>
<li><p>read in the local Global Burden of Disease (GBD) data:</p><ul><li><p>combine various head and neck cancers, combine myeloid leukemia diseases, combine respiratory diseases at level 2</p></li>
<li><p>adjust for rectum cancer in the combined colon and rectum cancer burden</p></li>
</ul></li>
<li><p>read in local demographic data:</p><ul><li><p>find / re-define max and min ages based on the max and min ages in the trip data, 
     the demographic data and the max and min ages considered in the model</p></li>
<li><p>remove any population data outside these max and min ages</p></li>
<li><p>find the proportion of the total population that is considered in the model to the total population</p></li>
<li><p>get age-category details from population data, after any ages above and below the max and min ages have been removed</p></li>
</ul></li>
<li><p>extract all diseases plus road injures from GBD data, update format of max and min ages for each entry</p></li>
<li><p>compute proportion of injuries in the age range considered in the model from the GBD data,
  this proportion is applied to those injury datasets without age and sex information</p></li>
<li><p>remove ages outside age ranges considered in model from GBD_data</p></li>
<li><p>create burden_of_disease dataframe from the GBD_data by changing the layout of the GBD_data:</p><ul><li><p>add city specific population data</p></li>
<li><p>add the country specific disease rate from the GBD data, ie. the proportion of the number of people 
     in the country with that disease over the population of the country for each age and sex category</p></li>
<li><p>using the country disease rate calculate the city population affected by the disease</p></li>
</ul></li>
<li><p>using the burden_of_disease data (now called DISEASE_BURDEN), calculate the ratio of
  YLL to death for each age and sex category for the road_injuries data</p></li>
<li><p>read in the city specific road injury data:</p><ul><li><p>Set a 'weight' column to the unique number of years for which injury data exists (if such column does not already exist)</p></li>
<li><p>where strike mode equals casualty mode, set the strike mode to 'nov' (no other vehicle)</p></li>
<li><p>call set_injury_contingency.R function to set tables for WHW (who hit whom) and NOV (no other vehicle) fatalities</p></li>
</ul></li>
</ul></div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Rob Johnson, Ali Abbas.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

