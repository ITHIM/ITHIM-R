<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Load data for model and setting — ithim_load_data • ithimr</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Load data for model and setting — ithim_load_data"><meta property="og:description" content="Loads and processes data from files. Local data for the setting and global data for the model.
Writes objects to the global environment."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ithimr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Load data for model and setting</h1>
    
    <div class="hidden name"><code>ithim_load_data.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Loads and processes data from files. Local data for the setting and global data for the model.
Writes objects to the global environment.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ithim_load_data</span><span class="op">(</span></span>
<span>  speeds <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>bus <span class="op">=</span> <span class="fl">10</span>, bus_driver <span class="op">=</span> <span class="fl">10</span>, minibus <span class="op">=</span> <span class="fl">10</span>, minibus_driver <span class="op">=</span> <span class="fl">10</span>, car <span class="op">=</span> <span class="fl">14.4</span>,</span>
<span>    car_driver <span class="op">=</span> <span class="fl">14.4</span>, taxi <span class="op">=</span> <span class="fl">12.6</span>, pedestrian <span class="op">=</span> <span class="fl">2.5</span>, walk_to_pt <span class="op">=</span> <span class="fl">2.5</span>, cycle <span class="op">=</span> <span class="fl">7.2</span>,</span>
<span>    motorcycle <span class="op">=</span> <span class="fl">15.2</span>, truck <span class="op">=</span> <span class="fl">10</span>, van <span class="op">=</span> <span class="fl">14.4</span>, subway <span class="op">=</span> <span class="fl">18.1</span>, rail <span class="op">=</span> <span class="fl">21.9</span>, auto_rickshaw</span>
<span>    <span class="op">=</span> <span class="fl">4</span>, shared_auto <span class="op">=</span> <span class="fl">14.4</span>, shared_taxi <span class="op">=</span> <span class="fl">12.6</span>, cycle_rickshaw <span class="op">=</span> <span class="fl">4</span>, other <span class="op">=</span> <span class="fl">9.1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>speeds</dt>
<dd><p>named list of mode speeds</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>This function performs the following steps to load and process the input data:</p>
<p>- find path of ithimr package where global and local data can be found
- check whether drpa package is installed
- read in Global Burden of Disease data for country
- read in city specific trip data and set missing stage or trip information to known stage or trip information, 
   e.g. if stage duration is missing but trip duration is known then set stage duration to trip duration
   - ensure that stage modes and trip modes only consist of set keywords, replace all other mode names by those key
     words, e.g. replace a 'train' by 'rail'
   - remove trips where age or sex are 'NA'
   - Rename pedestrian stage modes of non-pedestrian trips from 'pedestrian' to 'walk_to_pt'
   - remove any walk_to_pt stages that do not belong to either a rail or a bus trip mode
( - call get_scenario_settings() if using the max_mode_share_scenario)
- read in the local Global Burden of Disease (GBD) data
   - combine various head and neck cancers, combine myeloid leukemia diseases, combine respiratory diseases at level 2
   - adjust for rectum cancer in the combined colon and rectum cancer burden
- read in local demographic data
   - find / re-define max and min ages based on the max and min ages in the trip data, the demographic data and the max and min ages considered in the model
   - remove any population data outside these max and min ages
   - find the proportion of the total population and the total population that is considered in the model
   - get age-category details from population data, after any ages above and below the max and min ages have been removed
- extract all diseases plus road injures from GBD data, update format of max and min ages for each entry
- compute proportion of injuries in the age range considered in the model from the GBD data,
  this proportion is applied to those injury datasets without age and sex information
- remove ages outside age ranges considered in model from GBD_data 
- create burden_of_disease dataframe from the GBD_data by changing layout of GBD_data
   - add city specific population data
   - add the country specific disease rate from the GBD data, ie. the proportion of the number of people 
     in the country with that disease over the population of the country for each age and sex category
   - using the country disease rate calculate city population affected by disease
- using the burden_of_disease data (now called DISEASE_BURDEN), calculate the ratio of
  YLL to death for each age and sex category for the Road_injuries data 
- read in the city specific road injury data
  - Set a 'weight' column to the unique number of years for which injury data exists (if such column does not already exist)
  - where strike mode equals casualty mode, set the strike mode to 'nov' (no other vehicle)
  - call set_injury_contingency.R function to set tables for WHW (who hit whom) and NOV (no other vehicle) fatalities</p>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Rob Johnson, Ali Abbas.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

